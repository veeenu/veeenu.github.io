<!doctype html><html><head><meta charset=utf-8><meta content="width=device-width" name=viewport><meta content="A little fun with LeapMotion" property=og:title><meta content=website property=og:type><meta content="Andrea Venuta" property=og:site_name><meta content="I recently bought a LeapMotion. It&amp#x27;s a great little tool, although interacting with it has somewhat of a learning curve. The API on the other hand has quite a beautiful design, is very well documented and a couple of minutes of reading are enough to get started." property=og:description><title>A little fun with LeapMotion</title><link href=https://veeenu.github.io/style.css rel=stylesheet><link href=https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css rel=stylesheet><link integrity="sha512-vJqxkZ+Sugf/6WRlpcxN01qVfX/29hF6qc33eHF1va3NgoV+U+wCi+uTAsQ10sDoGyBxHLdaHvGwDlV3yVYboA==" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.1/katex.min.css referrerpolicy=no-referrer rel=stylesheet><script integrity="sha512-5ufNcHqOYgilGEHPfuRIQ5B/vDS1M8+UC+DESZ5CwVgGTg+b2Ol/15rYL/GiCWJ/Sx8oVo0FPFok1dPk8U9INQ==" crossorigin defer referrerpolicy=no-referrer src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.1/katex.min.js></script><script integrity="sha512-MBhOGY4yRA2eATtRGTcrDJCRqcnLai5+uu47GA2ueVr1MPzirC/iogLWRA8CXTlOTK09VI4fdTe4qE4LBfjsHw==" crossorigin defer referrerpolicy=no-referrer src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.1/contrib/mathtex-script-type.min.js></script><script integrity="sha512-ZA/RPrAo88DlwRnnoNVqKINnQNcWERzRK03PDaA4GIJiVZvGFIWQbdWCsUebMZfkWohnfngsDjXzU6PokO4jGw==" crossorigin defer referrerpolicy=no-referrer src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.1/contrib/auto-render.min.js></script><script>document.addEventListener(`DOMContentLoaded`,(()=>{let a=`\$\$`,b=`\$`;renderMathInElement(document.body,{delimiters:[{left:a,right:a,display:!0},{left:b,right:b,display:!1},{left:`\\\\(`,right:`\\\\)`,display:!1},{left:`\\\\[`,right:`\\\\]`,display:!0}],throwOnError:!1})}))</script><body><header id=menu-header><a class=image href=https://veeenu.github.io> <div><img alt="Andrea Venuta" src=https://veeenu.github.io/me.jpg></div> <span>Andrea Venuta</span> </a><ul><li><a href=https://veeenu.github.io>About</a><li><a href=https://veeenu.github.io/blog.html>Blog</a></ul></header><div class="container top-container"><article class="article twelve columns"><header><h1>A little fun with LeapMotion</h1><small> <p><time>Thursday, 10 Apr 2014</time> Â· <em> Reading time: 1 min </em></p> </small></header><section><p>I recently bought a <a href=https://www.leapmotion.com/>LeapMotion</a>. It's a great little tool, although interacting with it has somewhat of a learning curve. The API on the other hand has quite a beautiful design, is very well documented and a couple of minutes of reading are enough to get started.</p><span id=continue-reading></span><p>I'll have to take an exam about neural networks this summer, so later on I'll begin working on a neural network based gesture recognition system and will discuss it here.<p>Below you can see a very small example; if you own a LeapMotion, plug it in, point your finger towards the screen and move it around to draw. Despite <code>leapd</code> being quite heavy, and thus having a few hiccups on my somewhat old machine, the data flows seamlessly and the curves drawn are quite smooth. Depending on the task, developing an algorithm to compensate for unreasonably large jumps in position may be necessary -- the script in this page just stitches together the points as long as you stay past the hover area, maybe discarding a point if the distance between that and the one before that is larger than a set threshold would do the trick. Also I'm not really sure if the data collected by the LeapMotion comes in already normalized or using something like an inverse perspective projection matrix might do some good, I perceive some dissonance between my movements and the results on the screen when I use it but I can't really say if it's just a bit of lag. Will definitely have to look into it.<p>Anyway here's the canvas:<p><canvas height=300 id=canvas-2014-04-10-testing-leapmotion width=400></canvas></p><script src=//js.leapmotion.com/leap-0.4.3.js></script><script src=/data/2014-04-10/testing-leapmotion.js></script><p>And you get to read the source code, too. ;)<pre class=language-js data-lang=js style=color:#6c7079;background-color:#2b303b><code class=language-js data-lang=js><span style=color:#abb2bf>(</span><span style=color:#cd74e8>function</span><span style=color:#abb2bf>() {
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>  </span><span style=color:#9acc76>"use strict"</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>  </span><span style=color:#cd74e8>var </span><span style=color:#5cb3fa>main </span><span style=color:#adb7c9>= </span><span style=color:#cd74e8>function</span><span style=color:#abb2bf>() {
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>    </span><span style=color:#cd74e8>var </span><span style=color:#eb6772>ctl </span><span style=color:#adb7c9>= new </span><span style=color:#abb2bf>Leap.Controller({ enableGestures: </span><span style=color:#db9d63>false </span><span style=color:#abb2bf>}),
</span><span style=color:#abb2bf>        </span><span style=color:#eb6772>output </span><span style=color:#adb7c9>= </span><span style=color:#abb2bf>document.</span><span style=color:#5ebfcc>getElementById</span><span style=color:#abb2bf>(</span><span style=color:#9acc76>'canvas-2014-04-10-testing-leapmotion'</span><span style=color:#abb2bf>),
</span><span style=color:#abb2bf>        </span><span style=color:#eb6772>outCtx </span><span style=color:#adb7c9>= </span><span style=color:#eb6772>output</span><span style=color:#abb2bf>.</span><span style=color:#5ebfcc>getContext</span><span style=color:#abb2bf>(</span><span style=color:#9acc76>'2d'</span><span style=color:#abb2bf>),
</span><span style=color:#abb2bf>        </span><span style=color:#eb6772>paths </span><span style=color:#adb7c9>= </span><span style=color:#abb2bf>[[]],
</span><span style=color:#abb2bf>        </span><span style=color:#eb6772>tipPoint </span><span style=color:#adb7c9>= </span><span style=color:#abb2bf>{ x: </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>, y: </span><span style=color:#db9d63>0 </span><span style=color:#abb2bf>};
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>    </span><span style=color:#eb6772>output</span><span style=color:#abb2bf>.width </span><span style=color:#adb7c9>= </span><span style=color:#db9d63>400</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>    </span><span style=color:#eb6772>output</span><span style=color:#abb2bf>.height </span><span style=color:#adb7c9>= </span><span style=color:#db9d63>300</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>    </span><span style=color:#eb6772>output</span><span style=color:#abb2bf>.style.display </span><span style=color:#adb7c9>= </span><span style=color:#9acc76>'block'</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>    </span><span style=color:#eb6772>output</span><span style=color:#abb2bf>.style.</span><span style=color:#eb6772>position </span><span style=color:#adb7c9>= </span><span style=color:#9acc76>'relative'</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>    </span><span style=color:#eb6772>output</span><span style=color:#abb2bf>.style.</span><span style=color:#eb6772>margin </span><span style=color:#adb7c9>= </span><span style=color:#9acc76>'auto'</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>    </span><span style=color:#eb6772>output</span><span style=color:#abb2bf>.style.background </span><span style=color:#adb7c9>= </span><span style=color:#9acc76>'rgba(255, 255, 255, 0.3)'</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>    </span><span style=color:#eb6772>ctl</span><span style=color:#abb2bf>.</span><span style=color:#5cb3fa>on</span><span style=color:#abb2bf>(</span><span style=color:#9acc76>'frame'</span><span style=color:#abb2bf>, </span><span style=color:#cd74e8>function</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>evt</span><span style=color:#abb2bf>) {
</span><span style=color:#abb2bf>      </span><span style=color:#cd74e8>if</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>evt</span><span style=color:#abb2bf>.</span><span style=color:#eb6772>fingers</span><span style=color:#abb2bf>.length </span><span style=color:#adb7c9>=== </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>) </span><span style=color:#cd74e8>return</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>      </span><span style=color:#cd74e8>var </span><span style=color:#eb6772>pos </span><span style=color:#adb7c9>= </span><span style=color:#db9d63>null</span><span style=color:#abb2bf>, </span><span style=color:#eb6772>maxl </span><span style=color:#adb7c9>= </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>      </span><span style=color:#cd74e8>for</span><span style=color:#abb2bf>(</span><span style=color:#cd74e8>var </span><span style=color:#eb6772>i </span><span style=color:#adb7c9>= </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>; </span><span style=color:#eb6772>i </span><span style=color:#adb7c9>< </span><span style=color:#eb6772>evt</span><span style=color:#abb2bf>.</span><span style=color:#eb6772>fingers</span><span style=color:#abb2bf>.length; </span><span style=color:#eb6772>i</span><span style=color:#adb7c9>++</span><span style=color:#abb2bf>)
</span><span style=color:#abb2bf>        </span><span style=color:#cd74e8>if</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>evt</span><span style=color:#abb2bf>.</span><span style=color:#eb6772>fingers</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>i</span><span style=color:#abb2bf>].length </span><span style=color:#adb7c9>> </span><span style=color:#eb6772>maxl</span><span style=color:#abb2bf>) {
</span><span style=color:#abb2bf>          </span><span style=color:#eb6772>maxl </span><span style=color:#adb7c9>= </span><span style=color:#eb6772>evt</span><span style=color:#abb2bf>.</span><span style=color:#eb6772>fingers</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>i</span><span style=color:#abb2bf>].length;
</span><span style=color:#abb2bf>          </span><span style=color:#eb6772>pos </span><span style=color:#adb7c9>= </span><span style=color:#eb6772>evt</span><span style=color:#abb2bf>.</span><span style=color:#eb6772>fingers</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>i</span><span style=color:#abb2bf>].</span><span style=color:#eb6772>tipPosition</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>        }
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>      </span><span style=color:#cd74e8>var </span><span style=color:#eb6772>lastPath </span><span style=color:#adb7c9>= </span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>.length </span><span style=color:#adb7c9>- </span><span style=color:#db9d63>1</span><span style=color:#abb2bf>];
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>      </span><span style=color:#cd74e8>if</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>pos</span><span style=color:#abb2bf>[</span><span style=color:#db9d63>2</span><span style=color:#abb2bf>] </span><span style=color:#adb7c9>< </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>) {
</span><span style=color:#abb2bf>        </span><span style=color:#eb6772>lastPath</span><span style=color:#abb2bf>.</span><span style=color:#5ebfcc>push</span><span style=color:#abb2bf>({ x: </span><span style=color:#eb6772>pos</span><span style=color:#abb2bf>[</span><span style=color:#db9d63>0</span><span style=color:#abb2bf>] </span><span style=color:#adb7c9>+ </span><span style=color:#db9d63>200</span><span style=color:#abb2bf>, y: </span><span style=color:#db9d63>400 </span><span style=color:#adb7c9>- </span><span style=color:#eb6772>pos</span><span style=color:#abb2bf>[</span><span style=color:#db9d63>1</span><span style=color:#abb2bf>] });
</span><span style=color:#abb2bf>      } </span><span style=color:#cd74e8>else if</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>lastPath</span><span style=color:#abb2bf>.length </span><span style=color:#adb7c9>> </span><span style=color:#db9d63>0 </span><span style=color:#adb7c9>&& </span><span style=color:#eb6772>lastPath</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>lastPath</span><span style=color:#abb2bf>.length </span><span style=color:#adb7c9>- </span><span style=color:#db9d63>1</span><span style=color:#abb2bf>] </span><span style=color:#adb7c9>!== </span><span style=color:#db9d63>null</span><span style=color:#abb2bf>){
</span><span style=color:#abb2bf>        </span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>.</span><span style=color:#5ebfcc>push</span><span style=color:#abb2bf>([]);
</span><span style=color:#abb2bf>      }
</span><span style=color:#abb2bf>      </span><span style=color:#eb6772>tipPoint</span><span style=color:#abb2bf>.x </span><span style=color:#adb7c9>= </span><span style=color:#eb6772>pos</span><span style=color:#abb2bf>[</span><span style=color:#db9d63>0</span><span style=color:#abb2bf>] </span><span style=color:#adb7c9>+ </span><span style=color:#db9d63>200</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>      </span><span style=color:#eb6772>tipPoint</span><span style=color:#abb2bf>.y </span><span style=color:#adb7c9>= </span><span style=color:#db9d63>400 </span><span style=color:#adb7c9>- </span><span style=color:#eb6772>pos</span><span style=color:#abb2bf>[</span><span style=color:#db9d63>1</span><span style=color:#abb2bf>];
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>    });
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>    </span><span style=color:#eb6772>ctl</span><span style=color:#abb2bf>.</span><span style=color:#5cb3fa>connect</span><span style=color:#abb2bf>();
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>    </span><span style=color:#eb6772>output</span><span style=color:#abb2bf>.</span><span style=color:#5ebfcc>addEventListener</span><span style=color:#abb2bf>(</span><span style=color:#9acc76>'mousedown'</span><span style=color:#abb2bf>, </span><span style=color:#cd74e8>function</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>evt</span><span style=color:#abb2bf>) {
</span><span style=color:#abb2bf>      </span><span style=color:#5f697a;font-style:italic>// Cleanup
</span><span style=color:#abb2bf>      </span><span style=color:#cd74e8>while</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>.length)
</span><span style=color:#abb2bf>        </span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>.</span><span style=color:#5ebfcc>shift</span><span style=color:#abb2bf>();
</span><span style=color:#abb2bf>      </span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>.</span><span style=color:#5ebfcc>push</span><span style=color:#abb2bf>([]);
</span><span style=color:#abb2bf>      </span><span style=color:#eb6772>outCtx</span><span style=color:#abb2bf>.</span><span style=color:#5cb3fa>clearRect</span><span style=color:#abb2bf>(</span><span style=color:#db9d63>0</span><span style=color:#abb2bf>, </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>, </span><span style=color:#db9d63>400</span><span style=color:#abb2bf>, </span><span style=color:#db9d63>300</span><span style=color:#abb2bf>);
</span><span style=color:#abb2bf>    });
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>    </span><span style=color:#5cb3fa>requestAnimationFrame</span><span style=color:#abb2bf>(</span><span style=color:#cd74e8>function </span><span style=color:#5cb3fa>anim</span><span style=color:#abb2bf>() {
</span><span style=color:#abb2bf>      </span><span style=color:#eb6772>outCtx</span><span style=color:#abb2bf>.</span><span style=color:#5cb3fa>save</span><span style=color:#abb2bf>();
</span><span style=color:#abb2bf>      </span><span style=color:#eb6772>outCtx</span><span style=color:#abb2bf>.</span><span style=color:#5cb3fa>clearRect</span><span style=color:#abb2bf>(</span><span style=color:#db9d63>0</span><span style=color:#abb2bf>, </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>, </span><span style=color:#db9d63>400</span><span style=color:#abb2bf>, </span><span style=color:#db9d63>300</span><span style=color:#abb2bf>);
</span><span style=color:#abb2bf>      </span><span style=color:#cd74e8>for</span><span style=color:#abb2bf>(</span><span style=color:#cd74e8>var </span><span style=color:#eb6772>i </span><span style=color:#adb7c9>= </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>; </span><span style=color:#eb6772>i </span><span style=color:#adb7c9>< </span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>.length; </span><span style=color:#eb6772>i</span><span style=color:#adb7c9>++</span><span style=color:#abb2bf>) {
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>        </span><span style=color:#eb6772>outCtx</span><span style=color:#abb2bf>.</span><span style=color:#5cb3fa>beginPath</span><span style=color:#abb2bf>();
</span><span style=color:#abb2bf>        </span><span style=color:#cd74e8>for</span><span style=color:#abb2bf>(</span><span style=color:#cd74e8>var </span><span style=color:#eb6772>j </span><span style=color:#adb7c9>= </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>; </span><span style=color:#eb6772>j </span><span style=color:#adb7c9>< </span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>i</span><span style=color:#abb2bf>].length; </span><span style=color:#eb6772>j</span><span style=color:#adb7c9>++</span><span style=color:#abb2bf>)
</span><span style=color:#abb2bf>          </span><span style=color:#cd74e8>if</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>j </span><span style=color:#adb7c9>=== </span><span style=color:#db9d63>0</span><span style=color:#abb2bf>)
</span><span style=color:#abb2bf>            </span><span style=color:#eb6772>outCtx</span><span style=color:#abb2bf>.</span><span style=color:#5ebfcc>moveTo</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>i</span><span style=color:#abb2bf>][</span><span style=color:#eb6772>j</span><span style=color:#abb2bf>].x, </span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>i</span><span style=color:#abb2bf>][</span><span style=color:#eb6772>j</span><span style=color:#abb2bf>].y);
</span><span style=color:#abb2bf>          </span><span style=color:#cd74e8>else
</span><span style=color:#abb2bf>            </span><span style=color:#eb6772>outCtx</span><span style=color:#abb2bf>.</span><span style=color:#5cb3fa>lineTo</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>i</span><span style=color:#abb2bf>][</span><span style=color:#eb6772>j</span><span style=color:#abb2bf>].x, </span><span style=color:#eb6772>paths</span><span style=color:#abb2bf>[</span><span style=color:#eb6772>i</span><span style=color:#abb2bf>][</span><span style=color:#eb6772>j</span><span style=color:#abb2bf>].y);
</span><span style=color:#abb2bf>        </span><span style=color:#eb6772>outCtx</span><span style=color:#abb2bf>.</span><span style=color:#5cb3fa>stroke</span><span style=color:#abb2bf>();
</span><span style=color:#abb2bf>      }
</span><span style=color:#abb2bf>      </span><span style=color:#eb6772>outCtx</span><span style=color:#abb2bf>.</span><span style=color:#5cb3fa>restore</span><span style=color:#abb2bf>();
</span><span style=color:#abb2bf>      </span><span style=color:#5cb3fa>requestAnimationFrame</span><span style=color:#abb2bf>(</span><span style=color:#eb6772>anim</span><span style=color:#abb2bf>);
</span><span style=color:#abb2bf>    });
</span><span style=color:#abb2bf>  };
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>  </span><span style=color:#cd74e8>if</span><span style=color:#abb2bf>(document.readyState </span><span style=color:#adb7c9>=== </span><span style=color:#9acc76>'complete'</span><span style=color:#abb2bf>)
</span><span style=color:#abb2bf>    </span><span style=color:#5cb3fa>main</span><span style=color:#abb2bf>();
</span><span style=color:#abb2bf>  </span><span style=color:#cd74e8>else
</span><span style=color:#abb2bf>    window.</span><span style=color:#eb6772>onload </span><span style=color:#adb7c9>= </span><span style=color:#eb6772>main</span><span style=color:#abb2bf>;
</span><span style=color:#abb2bf>
</span><span style=color:#abb2bf>}());
</span></code></pre></section></article><ul class=links><li><a href=https://github.com/veeenu target=_blank> <img alt=GitHub src=/img/github.svg> </a><li><a href=https://www.linkedin.com/in/andreavenuta/ target=_blank> <img alt=LinkedIn src=/img/linkedin.svg> </a><li><a href=https://twitter.com/johndisandonato target=_blank> <img alt=Twitter src=/img/twitter.svg> </a><li><a href=https://twitch.tv/johndisandonato target=_blank> <img alt=Twitch.tv src=/img/twitch.svg> </a><li><a href=cv.pdf target=_blank> <img alt="CV - Icon made by Vitaly Gorbachev (https://www.flaticon.com/authors/vitaly-gorbachev) from www.flaticon.com" src=/img/cv.svg> </a></ul></div><script async src=/katex.min.js></script><script data-cf-beacon='{"token": "9c82a3cc7db742e4bb18aebd57b40893"}' defer src=https://static.cloudflareinsights.com/beacon.min.js></script>